(function(){var e,t,i,n,o,a,r,d,s;window.device={},t=window.document.documentElement,s=window.navigator.userAgent.toLowerCase(),device.ios=function(){return device.iphone()||device.ipod()||device.ipad()},device.iphone=function(){return i("iphone")},device.ipod=function(){return i("ipod")},device.ipad=function(){return i("ipad")},device.android=function(){return i("android")},device.androidPhone=function(){return device.android()&&i("mobile")},device.androidTablet=function(){return device.android()&&!i("mobile")},device.blackberry=function(){return i("blackberry")||i("bb10")||i("rim")},device.blackberryPhone=function(){return device.blackberry()&&!i("tablet")},device.blackberryTablet=function(){return device.blackberry()&&i("tablet")},device.windows=function(){return i("windows")},device.windowsPhone=function(){return device.windows()&&i("phone")},device.windowsTablet=function(){return device.windows()&&i("touch")},device.fxos=function(){return i("(mobile; rv:")||i("(tablet; rv:")},device.fxosPhone=function(){return device.fxos()&&i("mobile")},device.fxosTablet=function(){return device.fxos()&&i("tablet")},device.mobile=function(){return device.androidPhone()||device.iphone()||device.ipod()||device.windowsPhone()||device.blackberryPhone()||device.fxosPhone()},device.tablet=function(){return device.ipad()||device.androidTablet()||device.blackberryTablet()||device.windowsTablet()||device.fxosTablet()},device.portrait=function(){return 90!==Math.abs(window.orientation)},device.landscape=function(){return 90===Math.abs(window.orientation)},i=function(e){return-1!==s.indexOf(e)},o=function(e){var i;return i=new RegExp(e,"i"),t.className.match(i)},e=function(e){return o(e)?void 0:t.className+=" "+e},r=function(e){return o(e)?t.className=t.className.replace(e,""):void 0},device.ios()?device.ipad()?e("ios ipad tablet"):device.iphone()?e("ios iphone mobile"):device.ipod()&&e("ios ipod mobile"):e(device.android()?device.androidTablet()?"android tablet":"android mobile":device.blackberry()?device.blackberryTablet()?"blackberry tablet":"blackberry mobile":device.windows()?device.windowsTablet()?"windows tablet":device.windowsPhone()?"windows mobile":"desktop":device.fxos()?device.fxosTablet()?"fxos tablet":"fxos mobile":"desktop"),n=function(){return device.landscape()?(r("portrait"),e("landscape")):(r("landscape"),e("portrait"))},d="onorientationchange"in window,a=d?"orientationchange":"resize",window.addEventListener?window.addEventListener(a,n,!1):window.attachEvent?window.attachEvent(a,n):window[a]=n,n()}).call(this),function(e,t,i){"use strict";var n=function(t,i){this.element=t,this.$button_send=e('button[name="send"]',this.element),this.$button_file=e('button[name="file-btn"]',this.element),this.$requires=e("[required]",this.element),this.$file=e("#file",this.element),this.defaults={debug:!1},"object"==typeof i&&null!==i||(i={}),this.options=e.extend({},this.defaults,i),this.debug=this.options.debug};n.prototype={constructor:n,checkInput:function(t){var i,n=e(t),o={fname:"^([A-ZА-Я])([a-zA-Zа-яА-Яё ]){1,50}([a-zа-яё])$",email:"^[A-Za-z0-9](([_\\.\\-]?[a-zA-Z0-9]+)*)@([A-Za-z0-9]+)(([\\.\\-]?[a-zA-Z0-9]+)*)\\.([A-Za-z]{2,50})$",message:"^[-.,()a-zA-Z0-9а-яА-Я ]{5,500}$"};n.addClass("error").removeClass("valid"),"checkbox"==t.type&&t.checked&&e(t).removeClass("error");for(var a in o)t.name.indexOf(a)>-1&&(i=new RegExp(o[a]));i&&Boolean(i.test(t.value))&&n.addClass("valid").removeClass("error")},getData:function(){var e=this.element,t=new FormData;return e.querySelectorAll("[name]").forEach(function(e,i){t.append(e.name,e.value)}),this.$file&&t.set("file",this.$file.get(0).files[0]),t},error:function(){var t=this,i=this.element,n=e(i);return{alert:function(e){t.error().clear();var i=document.createElement("div");i.classList="form-error",i.innerHTML=e,n.before(i)},clear:function(){e(".form-error").remove()}}},send:function(){var t=this.element,i=e(t),n=i.attr("action"),o=this.getData(),a=this;e.ajax({url:n,type:"POST",data:o,processData:!1,contentType:!1,success:function(e){if(this.debug&&console.log("send success"),e=JSON.parse(e),this.debug&&console.log(e),["errors"]in e)Object.keys(e.errors).forEach(function(t,i){a.error().alert(e.errors[t][0]);var n=a.$button_send.find("span").get(0);n.innerHTML="",n.textContent=a.bufferText});else switch(t.id){case"form-send":window.location.href=i.attr("action")+"?"+i.serialize();break;case"form-login":window.location.href=t.querySelector('[name="_wp_http_referer"]').value}},error:function(e){console.log(e)}})},validate:function(){var t=this,i=e(this.element);this.$requires.each(function(e,i){t.checkInput(i)});var n=!e(".error",i).length;return this.debug&&console.log("check:"+n),n},init:function(){var t=this.element,i=(e(t),this),n=e(".file",t),o=e("svg",n),a=n.get(0).childNodes[0].textContent;this.$button_send.on("click",function(e){if(e.preventDefault(),i.validate()){var t=document.createElement("img");t.src="//"+location.host+"/images/loader.gif",t.width=18,t.height=18;var n=this.getElementsByTagName("span")[0];i.bufferText=n.textContent,n.textContent="... Подождите",n.insertBefore(t,n.firstChild),i.send()}}),this.$button_file.on("click",function(e){e.preventDefault(),this.$file.click()}),this.$file.change(function(){var e=this;e.files.length>0?(n.get(0).childNodes[0].textContent=e.files[0].name,o.show(),o.on("click",function(t){t.stopPropagation(),e.value="",n.get(0).childNodes[0].textContent=a,o.hide()})):(n.get(0).childNodes[0].textContent=a,o.hide())})}},e.fn.validate=function(t){return this.each(function(i,o){var a;e(o).data("validate")?a=e(o).data("validate"):(a=new n(o,t),a.init(o),e(o).data("validate",a))}),this}}(jQuery,window,document),function(){"use strict";var e=function(){var e=$("<div>").css({position:"absolute",top:"0px",left:"0px",width:"100px",height:"100px",visibility:"hidden",overflow:"scroll"});$("body").eq(0).append(e);var t=e.get(0).offsetWidth-e.get(0).clientWidth;return e.remove(),t},e=e(),t=document.getElementById("popup"),i=document.getElementById("overlay"),n=function(e,t){this.element=e,this.defaults={maxHeight:600,animationClass:null,onPopupShow:function(e){return!1}},"object"==typeof t&&null!==t||(t={}),this.options=$.extend({},this.defaults,t)};n.prototype={constructor:n,showModal:function(n){function o(){function e(){d.height()>a.options.maxHeight?s.css("height",d.height()):s.css("height",a.options.maxHeight)}function t(){(device.android()||device.iphone()||device.windowsPhone())&&(c.height(window.innerHeight+100),s.css("height",window.innerHeight+100))}window.innerHeight>a.options.maxHeight?(s.css("height",window.innerHeight),t(),e()):window.innerHeight>d.height()?(s.css("height",window.innerHeight),t()):e(),c.css({"overflow-y":"scroll"})}var a=this,r=this.element,d=$(n,this.popup),s=$(i),c=$(t);$("html").css({overflow:"hidden","padding-right":window.innerWidth>1279?e:device.android()||device.iphone()||device.windowsPhone()?0:e}),c.show(),d.show().addClass("opened"),this.currentModal=d,o(),this.options.animationClass&&d.addClass(this.options.animationClass),window.addEventListener("resize",function(){o()});var l=d.height();if(a.interval=setInterval(function(){d.height()>l&&(o(),clearInterval(a.interval))},300),this.options.onPopupShow&&this.options.onPopupShow(d),["src"]in r.dataset)for(var h=$(r.dataset.src).get(0),u=0;u<h.childElementCount;u++){var v=h.children[u];switch(v.dataset.role){case"text":$('[data-from="'+v.name+'"]',modal).html(v.value);break;case"src":$('[data-from="'+v.name+'"]',modal).get(0).src=v.value}}window.ShowHideModal=this},hideModal:function(e){var n=document.getElementById(e),o=$(n),a=($(i),$(t));$("html").css({"overflow-y":"scroll","padding-right":0}),a.hide(),o.hide().removeClass("opened"),this.options.animationClass&&o.removeClass(this.options.animationClass),clearInterval(self.interval)},init:function(){var e=this,t=this.element;$(t).on("click",function(i){i.preventDefault(),e.showModal(t.dataset.modal)}),$(".close-popup").each(function(t,i){i.onclick=function(){e.hideModal(i.parentNode.id)}}),i.onclick=function(t){var n=$(t.target);n.hasClass("popup__modal")||1==n.closest(".popup__modal").length?t.stopPropagation():e.hideModal($(".opened",i).attr("id"))}}},$.fn.showhidemodal=function(){var e,t,i=this,o=arguments[0];for(e=0;e<i.length;e++)if("object"==typeof o||void 0===o)i[e].showhidemodal=new n(i[e],o),i[e].showhidemodal.init(i[e]);else if(void 0!==t)return t;return i}}();